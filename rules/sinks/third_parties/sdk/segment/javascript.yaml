
#  Sink rule for ThirdParty SDK
#  The id follows a format : "ThirdParties.SDK.<THIRD_PARTY_ORGANISATION>.<SUB_ORGANISATION_IF_APPLICABLE>"

sinks:

  - id: ThirdParties.SDK.Segment
    name: Segment
    domains:
      - "segment.com"
    patterns:
      - "analytics.js-loader|analytics-node|@segment\\/snippet"
    tags:

  - id: ThirdParties.SDK.Segment
    name: Segment
    domains:
      - "segment.io"
    patterns:
      - "quepasa|@analytics\\/segment"
    tags:

  - id: ThirdParties.SDK.Pixel.Segment
    name: Segment
    domains:
      - "segment.io"
    filterProperty: "code"
    patterns:
      - "(?i)(.*(segmentpayloads)[.])?(logInternalEvent|identify|logPageView)[(].*"
    tags:
