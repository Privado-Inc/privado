
#  .* is a regular expression. Meaning the policy structure supports regex(case-sensitive).
#
#  The tags field in each policy object are the tags for referencing the policy.
#  These are not to be associated with sources'/sinks' tags.
#
#  In case no sinks key is defined inside a policy:
#  The policy will evaluate to true for any processing instance of corresponding sources being found
#  Thus a missing sink implies any kind of processing is Allowed/NotAllowed for given source

policies:  
  
  - id: Policy.Deny.Sharing.ContactToSlack
    name: "Example: Don't share contact data on Slack"
    type: Compliance
    description: "Policy to restrict Contact Information being shared with Slack"
    fix: "Talk to the Data Protection team: dataprotection@org.com"
    action: Deny    
    dataFlow:      
      sources:
        #  the below args follow following format => dir_structure_under_rules_folder:sourceId
        - "Data.Sensitive.ContactData.*"
        - "Data.Sensitive.PersonalIdentification.PhoneNumber"
      
      sinks:
        - "Data.Sharing.Slack"
      
    repositories:      # optional field default value : - .*
      - "privado-messaging-app"
      - "Order Manager"
      - "accounts.*"

    tags:
  
  - id: Policy.Deny.Sharing.PIISavedToDatabase
    name: "Don't save PII within cache or Storage"
    type: Compliance
    description: "Policy to restrict storing PII in cache or Storage"
    fix: "Talk to the Data Protection team: dataprotection@org.com"
    action: Deny    
    dataFlow: 
      sources:
        - Data.Sensitive.ContactData.*             
      sinks:
        - Storages.*
    repositories:
      - "**"
    tags:
  
  # - id: Policy.Deny.Processing.ProtectionAgainstVisitorTracking
  #   name: "Protection against tracking of visitors of websites via OnlineIdentifiers"
  #   type: Compliance
  #   description: "This pattern avoids the tracking of visitors of websites via cookies. It does this by deleting them at regular intervals or by disabling cookies completely."
  #   fix: "Talk to the Data Protection team: dataprotection@org.com"
  #   action: Deny    
  #   dataFlow: 
  #     sources:
  #       - Data.Sensitive.OnlineIdentifiers.*
  #   repositories:
  #     - "**"
  #   tags:
  
  # - id: Policy.Deny.Processing.InfosysPrivacyLoggerUsed
  #   name: "Infosys Privacy Logger component is used and implemented in code"
  #   type: Compliance
  #   description: "Infosys Privacy Logger component is a reusable component available for Java, C#, etc that protects the logs from leaking PII data. This component needs to be used in all applications."
  #   fix: "Talk to the Data Protection team: dataprotection@org.com"
  #   action: Deny
  #   dataFlow:
  #     sources:
  #       - Data.Sensitive.*
  #     sinks:
  #       - Leakages.Log.InfosysPortfolio.Logger
  #   repositories:
  #     - "**"
  #   tags:
  #     policyPurpose: "Security Audit"

  - id: Policy.Allow.Processing.FinancialData
    name: "Example: Don't use financial data outside of payments services"
    type: Compliance
    description: "Policy to allow processing Financial Information only in payments services"
    fix: "Talk to the Data Protection team: dataprotection@org.com"
    action: Allow
    dataFlow:
      sources:
        - "Data.Sensitive.FinancialData.*"
    repositories:
      - "payments-.*"
    tags:
      policyPurpose: "Security Audit"
  
